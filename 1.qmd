title: "Estadística Descriptiva. Gráficas Variables Cuantitativas."
format: 
  html:
    grid: 
      body-width: 950px
editor: visual
lang: es
---

```{r}
#| code-fold: true
#| warning: false
#| message: false

# Cargar librerías
library(tidyverse)    # Para manipulación de datos
library(sf)          # Para datos espaciales
library(viridis)     # Para paletas de colores
library(tmap) #Dibujar el mapa
library(sf) #Para leer el shapefile y reducir el tama?o del archivo
library(pryr) #Calcular el tama?o del archivo
library("readr") #para cargar csv
library(base) # para merge
library(reshape2) # para hacer dcast
library(plyr) # para mineria en csv
library(janitor)    # Para limpiar nombres de columnas
library(scales)     # Para mejorar ejes en gráficos
library(dplyr) # para inner join

```


```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

#municipios_SanLuisPotosi <- st_read("1_estadistica_descriptiva/data/14mun.shp", options = "ENCODING=LATIN1", quiet = TRUE)
municipios_SanLuisPotosi <- st_read("data/24mun.shp", options = "ENCODING=LATIN1", quiet = TRUE)

# Crear mapa de municipios de SanLuisPotosi
mapa_municipios <- ggplot(municipios_SanLuisPotosi) +
  geom_sf(fill = "darkgreen", color = "white", size = 0.3) +
  labs(
    title = "Municipios de SanLuisPotosi",
    subtitle = paste("Total de municipios:", nrow(municipios_SanLuisPotosi)),
    caption = "Fuente: INEGI - Marco Geoestadístico"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12),
    plot.caption = element_text(size = 10)
  )

print(mapa_municipios)
```


```{r}
#| code-fold: true
#| warning: false
#| message: false


#datos_total <- read_csv("1_estadistica_descriptiva/data/cpv_valor_24.csv", na = c("ND"))
datos_total <- read_csv("data/cpv_valor_24.csv", na = c("ND"))

datos_total <- datos_total |> filter(año == 2020)
#unique(datos_total$indicador)
datos_seleccion <- datos_total |> 
  filter(indicador %in% c("Viviendas habitadas", "Índice de envejecimiento", "Tamaño promedio de los hogares con jefe hombre", "Tamaño promedio de los hogares con jefe mujer", "Relación de dependencia" ), desc_municipio != "Estatal") |> 
  select(desc_municipio, indicador, valor)
```

```{r}
#| code-fold: true
#| warning: false
#| message: false

datos <- datos_seleccion |>
    pivot_wider(names_from = indicador, values_from = valor) 

datos <- datos |> 
  clean_names() 

# Corrección de nombres de municipios

datos <- datos |> 
  mutate(desc_municipio = if_else(desc_municipio == "EL Arenal", "El Arenal", desc_municipio))

datos <- datos |> 
  mutate(NOMGEO = desc_municipio)
```

# Estadísticas descriptivas

Ahora que tenemos nuestros datos preparados, podemos realizar un resumen numérico de las variables cuantitativas. Para ello, utilizaremos la función `summary()` de R, que nos proporcionará un resumen estadístico de cada variable, incluyendo la media, mediana, mínimo, máximo y cuartiles. Hay que agregar las demás medidas de dispersión analizadas en clase (desviación media, varianza, rango, etc.) para cada variable cuantitativa.

```{r}
#| code-fold: true

summary(datos)
```

Se unen los datos geograficos de los municipios de SanLuisPotosi con los datos de población y vivienda. Esto nos permitirá crear mapas y realizar análisis espaciales. Para preservar la integridad de los datos, utilizamos `left_join()` de `dplyr`, el primer conjunto de datos debe ser el que contenga la columna `geometry`.

```{r}
#| code-fold: true

datos <- left_join(municipios_SanLuisPotosi, datos)
```

## Indice de envejecimiento (Mediana)

```{r}
#| code-fold: true
#| fig-width: 16
#| fig-align: center

ggplot(datos) +
  geom_sf(aes(fill = indice_de_envejecimiento), color = "white", size = 0.1) +
  scale_fill_viridis_c(
    name = "Indice de envejecimiento",
  ) +
  labs(
    title = "Indice de envejecimiento de los Municipios de San Luis Potosi",
    caption = "Fuente: INEGI - Marco Geoestadístico"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12),
    plot.caption = element_text(size = 10),
    legend.position = "right"
  )


```

A continuación, se presentan diferentes tipos de gráficos para visualizar la distribución de una sola variable cuantitativa, en este caso, la edad mediana de los municipios de SanLuisPotosi. Estos gráficos son útiles para comprender la distribución y características de la variable. En cada caso, es necesario que incluyas cómo se lleva a cabo cada gráfico y posteriormente, la interpretación de los resultados.

## Histograma

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(datos) +
  geom_histogram(aes(indice_de_envejecimiento), color="black", fill = "olivedrab", boundary=min(datos$indice_de_envejecimiento), binwidth = 2) +
  labs(
    title = "Distribución de la Edad",
    x = "Envejecimiento", y = "Frecuencia"
  ) +
  theme_bw()+
  theme(
    legend.title = element_text(size=5, face="bold"),
    legend.text = element_text(size=5),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13)
  )

```

## Gráfica de densidad

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(datos) +
  geom_density(aes(indice_de_envejecimiento), color="black", fill = "firebrick", alpha=0.6) +
  labs(
    title = "Distribución de envejecimiento",  
    x = "Porcentaje", y = "Densidad"
  ) +
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13)
  )


```

## Boxplot

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(data = datos, aes(x = "", y = indice_de_envejecimiento)) +
    geom_boxplot(
    fill = "#4A90E2",           # Color de relleno
    color = "#2C5F7A",          # Color del borde más oscuro
    alpha = 0.8,                # Transparencia
    outlier.color = "#E74C3C",  # Color rojo para outliers
    outlier.size = 2.5,         # Tamaño de outliers
    outlier.alpha = 0.7,        # Transparencia de outliers
    width = 0.5,                # Ancho del boxplot
    notch = TRUE,               # Muescas para intervalo de confianza
    notchwidth = 0.7            # Ancho de las muescas
  ) +
  geom_jitter(alpha = 0.3, color = "#34495E", size = 1.5, width = 0.1) +
  scale_y_continuous(breaks = pretty_breaks(n = 8), labels = function(x) paste(x, "%")) +
  labs(title = "% envejecimiento (mediana)", 
  subtitle = "Población del Estado de SanLuisPotosi",
  y = "% envejecimiento",
  x = "")+
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=10),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
```

## Gráfico de violín

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(data = datos, aes(x = "", y = indice_de_envejecimiento)) +
    geom_violin(fill = "#4A90E2", color = "#2C5F7A", alpha = 0.8,
    trim = FALSE,               # No recortar las colas
    scale = "width", width = 0.8, linewidth = 0.8) +
    geom_boxplot( width = 0.15, fill = "white", color = "#2C5F7A", alpha = 0.9,
    outlier.color = "#E74C3C", outlier.size = 1.5, outlier.alpha = 0.8, notch = FALSE) +
  stat_summary(fun = median, geom = "point", shape = 21, size = 3, fill = "white",
  color = "#2C5F7A", stroke = 1.5) +
  geom_jitter(alpha = 0.2, color = "#34495E", size = 0.8, width = 0.05) +
  scale_y_continuous(breaks = pretty_breaks(n = 8), labels = function(x) paste(x, "%")) +
  labs(title = "% envejecimiento", 
  subtitle = "Población del Estado de SanLuisPotosi",
  y = "% envejecimiento",
  x = "")+
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=10),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
  
```

## Q-Q Plot (comparación de cuantiles)

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center


# Q-Q Plot básico para normalidad
ggplot(data = datos, aes(sample = indice_de_envejecimiento)) +
    stat_qq(color = "#4A90E2", size = 2, alpha = 0.7) +
    stat_qq_line(color = "#E74C3C", linewidth = 1, linetype = "dashed") +
    scale_x_continuous(name = "Cuantiles Teóricos (Distribución Normal)",
    breaks = pretty_breaks(n = 6)) +
    scale_y_continuous(name = "Cuantiles Muestrales (PEA <=12)",
    breaks = pretty_breaks(n = 6),
    labels = function(x) paste(x, "%")) +
    labs(title = "Gráfico Q-Q para Normalidad",
    subtitle = "Indice de envejecimiento (%) - Población SanLuisPotosi") +
    theme_bw()+
    theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=15, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
  


```

## Dot Plot (Gráfico de puntos)

```{r}
#| code-fold: true
#| fig-width: 8
#| fig-height: 16
#| fig-align: center

ggplot(data = datos, aes(x = indice_de_envejecimiento, y = reorder(NOMGEO, indice_de_envejecimiento))) +
  geom_point(color = "#4A90E2", size = 3, alpha = 0.8) +
  geom_segment(aes(x = 0, xend = indice_de_envejecimiento, y = NOMGEO, yend = NOMGEO),
    color = "#BDC3C7", size = 0.5, alpha = 0.7) +
  scale_x_continuous(
    name = "Índice de envejecimiento",
    breaks = pretty_breaks(n = 6),
    expand = expansion(mult = c(0, 0.1))) +
  scale_y_discrete(
    name = "Municipios",
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  labs(
    title = "Dot Plot - Indice de envejecimiento (%) por Municipio",
    subtitle = "Estado de SanLuisPotosi") +
  theme_bw()+
    theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=7, face="bold"),
    plot.subtitle = element_text(size=8),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=9),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )

```

## Tamaño promedio de los hogares con jefe hombre  (Mediana)

```{r}
#| code-fold: true
#| fig-width: 16
#| fig-align: center

ggplot(datos) +
  geom_sf(aes(fill = tamano_promedio_de_los_hogares_con_jefe_hombre), color = "white", size = 0.1) +
  scale_fill_viridis_c(
    name = "Tamaño promedio de los hogares con jefe hombre",
  ) +
  labs(
    title = "Promedio de hogares con jefe hombre",
    caption = "Fuente: INEGI - Marco Geoestadístico"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12),
    plot.caption = element_text(size = 10),
    legend.position = "right"
  )


```

A continuación, se presentan diferentes tipos de gráficos para visualizar la distribución de una sola variable cuantitativa, en este caso, la edad mediana de los municipios de SanLuisPotosi. Estos gráficos son útiles para comprender la distribución y características de la variable. En cada caso, es necesario que incluyas cómo se lleva a cabo cada gráfico y posteriormente, la interpretación de los resultados.

## Histograma

```{r}
#| code-fold: true
#| fig-width: 10
#| fig-align: center

ggplot(datos) +
  geom_histogram(aes(tamano_promedio_de_los_hogares_con_jefe_hombre), color="black", fill = "olivedrab", boundary=min(datos$tamano_promedio_de_los_hogares_con_jefe_hombre), binwidth = 0.2) +
  labs(
    title = "Distribución de hogares con jefe hombre",
    x = "Hogares con jefe hombre", y = "Frecuencia"
  ) +
  theme_bw()+
  theme(
    legend.title = element_text(size=5, face="bold"),
    legend.text = element_text(size=5),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13)
  )

```

## Gráfica de densidad

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(datos) +
  geom_density(aes(tamano_promedio_de_los_hogares_con_jefe_hombre), color="black", fill = "firebrick", alpha=0.6) +
  labs(
    title = "Distribución de jefe hombre",  
    x = "Porcentaje", y = "Densidad"
  ) +
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13)
  )


```

## Boxplot

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(data = datos, aes(x = "", y = tamano_promedio_de_los_hogares_con_jefe_hombre)) +
    geom_boxplot(
    fill = "#4A90E2",           # Color de relleno
    color = "#2C5F7A",          # Color del borde más oscuro
    alpha = 0.8,                # Transparencia
    outlier.color = "#E74C3C",  # Color rojo para outliers
    outlier.size = 2.5,         # Tamaño de outliers
    outlier.alpha = 0.7,        # Transparencia de outliers
    width = 0.5,                # Ancho del boxplot
    notch = TRUE,               # Muescas para intervalo de confianza
    notchwidth = 0.7            # Ancho de las muescas
  ) +
  geom_jitter(alpha = 0.3, color = "#34495E", size = 1.5, width = 0.1) +
  scale_y_continuous(breaks = pretty_breaks(n = 8), labels = function(x) paste(x, "%")) +
  labs(title = "Hogares con jefe hombres (mediana)", 
  subtitle = "Población del Estado de SanLuisPotosi",
  y = "% jefes hombres por hogar",
  x = "")+
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=10),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
```

## Gráfico de violín

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(data = datos, aes(x = "", y = tamano_promedio_de_los_hogares_con_jefe_hombre)) +
    geom_violin(fill = "#4A90E2", color = "#2C5F7A", alpha = 0.8,
    trim = FALSE,               # No recortar las colas
    scale = "width", width = 0.8, linewidth = 0.8) +
    geom_boxplot( width = 0.15, fill = "white", color = "#2C5F7A", alpha = 0.9,
    outlier.color = "#E74C3C", outlier.size = 1.5, outlier.alpha = 0.8, notch = FALSE) +
  stat_summary(fun = median, geom = "point", shape = 21, size = 3, fill = "white",
  color = "#2C5F7A", stroke = 1.5) +
  geom_jitter(alpha = 0.2, color = "#34495E", size = 0.8, width = 0.05) +
  scale_y_continuous(breaks = pretty_breaks(n = 8), labels = function(x) paste(x, "%")) +
  labs(title = "Hogares con jefe hombres (mediana)o", 
  subtitle = "Población del Estado de SanLuisPotosi",
  y = "promedio de jefe hombre promedio",
  x = "")+
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=10),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
  
```

## Q-Q Plot (comparación de cuantiles)

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center


# Q-Q Plot básico para normalidad
ggplot(data = datos, aes(sample = tamano_promedio_de_los_hogares_con_jefe_hombre)) +
    stat_qq(color = "#4A90E2", size = 2, alpha = 0.7) +
    stat_qq_line(color = "#E74C3C", linewidth = 1, linetype = "dashed") +
    scale_x_continuous(name = "Cuantiles Teóricos (Distribución Normal)",
    breaks = pretty_breaks(n = 6)) +
    scale_y_continuous(name = "Cuantiles Muestrales (PEA <=12)",
    breaks = pretty_breaks(n = 6),
    labels = function(x) paste(x, "%")) +
    labs(title = "Gráfico Q-Q para Normalidad",
    subtitle = "Promedio de hogares con jefe hombre) - Población SanLuisPotosi") +
    theme_bw()+
    theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=15, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
  


```

## Dot Plot (Gráfico de puntos)

```{r}
#| code-fold: true
#| fig-width: 8
#| fig-height: 16
#| fig-align: center

ggplot(data = datos, 
       aes(x = tamano_promedio_de_los_hogares_con_jefe_hombre, 
           y = reorder(NOMGEO, tamano_promedio_de_los_hogares_con_jefe_hombre))) +
  geom_segment(aes(x = 0, 
                   xend = tamano_promedio_de_los_hogares_con_jefe_hombre, 
                   y = NOMGEO, 
                   yend = NOMGEO), 
               color = "#BDC3C7", size = 0.5, alpha = 0.7, na.rm = TRUE) +
  geom_point(color = "#4A90E2", size = 3, alpha = 0.8, na.rm = TRUE) +
  scale_x_continuous(
    name = "Promedio de hogar con jefa hombre",
    breaks = pretty_breaks(n = 6),
    expand = expansion(mult = c(0, 0.1))
  ) +
  scale_y_discrete(
    name = "Municipios",
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  labs(
    title = "Dot Plot – Promedio de los hogares con jefa hombre por municipio",
    subtitle = "Estado de San Luis Potosí"
  ) +
  theme_bw() +
  theme(
    legend.title = element_text(size = 13, face = "bold"),
    legend.text  = element_text(size = 13),
    plot.title   = element_text(size = 7, face = "bold"),
    plot.subtitle= element_text(size = 8),
    axis.text.x  = element_text(size = 12),
    axis.text.y  = element_text(size = 9),
    axis.title.x = element_text(face = "bold", size = 13),
    axis.title.y = element_text(face = "bold", size = 13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5, linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background   = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )

```

## Tamaño promedio de los hogares con jefe mujer  (Mediana)

```{r}
#| code-fold: true
#| fig-width: 16
#| fig-align: center

ggplot(datos) +
  geom_sf(aes(fill = tamano_promedio_de_los_hogares_con_jefe_mujer), color = "white", size = 0.1) +
  scale_fill_viridis_c(
    name = "Tamaño promedio de los hogares con jefe mujer",
  ) +
  labs(
    title = "Promedio de hogares con jefe mujer",
    caption = "Fuente: INEGI - Marco Geoestadístico"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    plot.subtitle = element_text(size = 12),
    plot.caption = element_text(size = 10),
    legend.position = "right"
  )


```

A continuación, se presentan diferentes tipos de gráficos para visualizar la distribución de una sola variable cuantitativa, en este caso, la edad mediana de los municipios de SanLuisPotosi. Estos gráficos son útiles para comprender la distribución y características de la variable. En cada caso, es necesario que incluyas cómo se lleva a cabo cada gráfico y posteriormente, la interpretación de los resultados.

## Histograma

```{r}
#| code-fold: true
#| fig-width: 10
#| fig-align: center

ggplot(datos) +
  geom_histogram(aes(x = tamano_promedio_de_los_hogares_con_jefe_mujer), 
               color="black", 
               fill = "olivedrab", 
               boundary=min(datos$tamano_promedio_de_los_hogares_con_jefe_mujer, na.rm = TRUE), 
               binwidth = 0.2) +
  labs(
    title = "Distribución de hogares con jefe mujer",
    x = "Hogares con jefe mujer", y = "Frecuencia"
  ) +
  theme_bw()+
  theme(
    legend.title = element_text(size=5, face="bold"),
    legend.text = element_text(size=5),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13)
  )

```

## Gráfica de densidad

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(datos) +
   geom_density(aes(x = tamano_promedio_de_los_hogares_con_jefe_mujer), color = "black", fill = "firebrick", alpha = 0.6, na.rm = TRUE) +
  labs(
    title = "Distribución de jefe mujer",  
    x = "Porcentaje", y = "Densidad"
  ) +
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13)
  )


```

## Boxplot

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(data = datos, aes(x = "", y = tamano_promedio_de_los_hogares_con_jefe_mujer)) +
    geom_boxplot(
    fill = "#4A90E2",           # Color de relleno
    color = "#2C5F7A",          # Color del borde más oscuro
    alpha = 0.8,                # Transparencia
    outlier.color = "#E74C3C",  # Color rojo para outliers
    outlier.size = 2.5,         # Tamaño de outliers
    outlier.alpha = 0.7,        # Transparencia de outliers
    width = 0.5,                # Ancho del boxplot
    notch = TRUE,               # Muescas para intervalo de confianza
    notchwidth = 0.7            # Ancho de las muescas
  ) +
  geom_jitter(alpha = 0.3, color = "#34495E", size = 1.5, width = 0.1) +
  scale_y_continuous(breaks = pretty_breaks(n = 8), labels = function(x) paste(x, "%")) +
  labs(title = "Hogares con jefe mujeres (mediana)", 
  subtitle = "Población del Estado de SanLuisPotosi",
  y = "% jefes mujeres por hogar",
  x = "")+
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=10),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
```

## Gráfico de violín

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center

ggplot(data = datos, aes(x = "", y = tamano_promedio_de_los_hogares_con_jefe_mujer)) +
    geom_violin(fill = "#4A90E2", color = "#2C5F7A", alpha = 0.8,
    trim = FALSE,               # No recortar las colas
    scale = "width", width = 0.8, linewidth = 0.8) +
    geom_boxplot( width = 0.15, fill = "white", color = "#2C5F7A", alpha = 0.9,
    outlier.color = "#E74C3C", outlier.size = 1.5, outlier.alpha = 0.8, notch = FALSE) +
  stat_summary(fun = median, geom = "point", shape = 21, size = 3, fill = "white",
  color = "#2C5F7A", stroke = 1.5) +
  geom_jitter(alpha = 0.2, color = "#34495E", size = 0.8, width = 0.05) +
  scale_y_continuous(breaks = pretty_breaks(n = 8), labels = function(x) paste(x, "%")) +
  labs(title = "Hogares con jefe mujeres (mediana)o", 
  subtitle = "Población del Estado de SanLuisPotosi",
  y = "promedio de jefe mujer promedio",
  x = "")+
  theme_bw()+
  theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=10, face="bold"),
    plot.subtitle = element_text(size=10),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
  
```

## Q-Q Plot (comparación de cuantiles)

```{r}
#| code-fold: true
#| fig-width: 7
#| fig-align: center


# Q-Q Plot básico para normalidad
ggplot(data = datos, aes(sample = tamano_promedio_de_los_hogares_con_jefe_mujer)) +
    stat_qq(color = "#4A90E2", size = 2, alpha = 0.7) +
    stat_qq_line(color = "#E74C3C", linewidth = 1, linetype = "dashed") +
    scale_x_continuous(name = "Cuantiles Teóricos (Distribución Normal)",
    breaks = pretty_breaks(n = 6)) +
    scale_y_continuous(name = "Cuantiles Muestrales (PEA <=12)",
    breaks = pretty_breaks(n = 6),
    labels = function(x) paste(x, "%")) +
    labs(title = "Gráfico Q-Q para Normalidad",
    subtitle = "Promedio de hogares con jefe mujer) - Población SanLuisPotosi") +
    theme_bw()+
    theme(
    legend.title = element_text(size=13, face="bold"),
    legend.text = element_text(size=13),
    plot.title = element_text(size=15, face="bold"),
    plot.subtitle = element_text(size=13),
    axis.text.x=element_text(size=12),
    axis.text.y=element_text(size=12),
    axis.title.x = element_text(face="bold", size=13),
    axis.title.y = element_text(face="bold", size=13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5,
      linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )
  


```

## Dot Plot (Gráfico de puntos)

```{r}
#| code-fold: true
#| fig-width: 8
#| fig-height: 16
#| fig-align: center

ggplot(data = datos, 
       aes(x = tamano_promedio_de_los_hogares_con_jefe_mujer, 
           y = reorder(NOMGEO, tamano_promedio_de_los_hogares_con_jefe_mujer))) +
  geom_segment(aes(x = 0, 
                   xend = tamano_promedio_de_los_hogares_con_jefe_mujer, 
                   y = NOMGEO, 
                   yend = NOMGEO), 
               color = "#BDC3C7", size = 0.5, alpha = 0.7, na.rm = TRUE) +
  geom_point(color = "#4A90E2", size = 3, alpha = 0.8, na.rm = TRUE) +
  scale_x_continuous(
    name = "Promedio de hogar con jefa mujer",
    breaks = pretty_breaks(n = 6),
    expand = expansion(mult = c(0, 0.1))
  ) +
  scale_y_discrete(
    name = "Municipios",
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  labs(
    title = "Dot Plot – Promedio de los hogares con jefa mujer por municipio",
    subtitle = "Estado de San Luis Potosí"
  ) +
  theme_bw() +
  theme(
    legend.title = element_text(size = 13, face = "bold"),
    legend.text  = element_text(size = 13),
    plot.title   = element_text(size = 7, face = "bold"),
    plot.subtitle= element_text(size = 8),
    axis.text.x  = element_text(size = 12),
    axis.text.y  = element_text(size = 9),
    axis.title.x = element_text(face = "bold", size = 13),
    axis.title.y = element_text(face = "bold", size = 13),
    panel.grid.major.y = element_line(color = "#ECF0F1", linewidth = 0.5, linetype = "dashed"),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.background   = element_rect(fill = "#FAFAFA", color = NA),
    plot.background = element_rect(fill = "white", color = NA)
  )

```


























